<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect x="0" y="0" width="800" height="600" fill="#f5f5f5"/>
  
  <!-- Title -->
  <text x="400" y="30" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">IoT Agriculture Security Architecture</text>
  
  <!-- Secure Components Group -->
  <rect x="50" y="70" width="700" height="180" rx="10" ry="10" fill="#e6f7ff" stroke="#0099cc" stroke-width="2"/>
  <text x="400" y="90" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Secure IoT System</text>
  
  <!-- Sensor -->
  <rect x="100" y="110" width="120" height="80" rx="5" ry="5" fill="#ffffff" stroke="#27ae60" stroke-width="2"/>
  <text x="160" y="145" font-family="Arial" font-size="12" text-anchor="middle">Secure Sensor</text>
  <text x="160" y="165" font-family="Arial" font-size="10" text-anchor="middle">Signed/Encrypted</text>
  
  <!-- RabbitMQ -->
  <rect x="340" y="110" width="120" height="80" rx="5" ry="5" fill="#ffffff" stroke="#27ae60" stroke-width="2"/>
  <text x="400" y="145" font-family="Arial" font-size="12" text-anchor="middle">RabbitMQ</text>
  <text x="400" y="165" font-family="Arial" font-size="10" text-anchor="middle">Secure Exchanges</text>
  
  <!-- Web Server -->
  <rect x="580" y="110" width="120" height="80" rx="5" ry="5" fill="#ffffff" stroke="#27ae60" stroke-width="2"/>
  <text x="640" y="145" font-family="Arial" font-size="12" text-anchor="middle">Secure Web Server</text>
  <text x="640" y="165" font-family="Arial" font-size="10" text-anchor="middle">Verification/Decryption</text>
  
  <!-- Dashboard (below Web Server) -->
  <rect x="580" y="220" width="120" height="80" rx="5" ry="5" fill="#ffffff" stroke="#27ae60" stroke-width="2"/>
  <text x="640" y="255" font-family="Arial" font-size="12" text-anchor="middle">Secure Dashboard</text>
  <text x="640" y="275" font-family="Arial" font-size="10" text-anchor="middle">Security Status Display</text>
  
  <!-- Attack Simulation Group -->
  <rect x="50" y="280" width="450" height="180" rx="10" ry="10" fill="#ffecec" stroke="#cc0000" stroke-width="2"/>
  <text x="275" y="300" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Attack Simulation</text>
  
  <!-- Message Sniffer -->
  <rect x="80" y="320" width="120" height="80" rx="5" ry="5" fill="#ffffff" stroke="#e74c3c" stroke-width="2"/>
  <text x="140" y="355" font-family="Arial" font-size="12" text-anchor="middle">Message Sniffer</text>
  <text x="140" y="375" font-family="Arial" font-size="10" text-anchor="middle">Eavesdropping</text>
  
  <!-- Message Spoofer -->
  <rect x="215" y="320" width="120" height="80" rx="5" ry="5" fill="#ffffff" stroke="#e74c3c" stroke-width="2"/>
  <text x="275" y="355" font-family="Arial" font-size="12" text-anchor="middle">Message Spoofer</text>
  <text x="275" y="375" font-family="Arial" font-size="10" text-anchor="middle">Fake Commands</text>
  
  <!-- MITM Attacker -->
  <rect x="350" y="320" width="120" height="80" rx="5" ry="5" fill="#ffffff" stroke="#e74c3c" stroke-width="2"/>
  <text x="410" y="355" font-family="Arial" font-size="12" text-anchor="middle">MITM Attacker</text>
  <text x="410" y="375" font-family="Arial" font-size="10" text-anchor="middle">Message Tampering</text>
  
  <!-- Security Countermeasures Group -->
  <rect x="50" y="480" width="700" height="100" rx="10" ry="10" fill="#e6ffe6" stroke="#006600" stroke-width="2"/>
  <text x="400" y="500" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Security Countermeasures</text>
  
  <!-- Security Monitor -->
  <rect x="350" y="520" width="120" height="40" rx="5" ry="5" fill="#ffffff" stroke="#27ae60" stroke-width="2"/>
  <text x="410" y="543" font-family="Arial" font-size="12" text-anchor="middle">Security Monitor</text>
  
  <!-- Countermeasures List -->
  <text x="80" y="525" font-family="Arial" font-size="10">✓ Message Signing (HMAC-SHA256)</text>
  <text x="80" y="545" font-family="Arial" font-size="10">✓ Encryption (AES-256-CBC)</text>
  <text x="80" y="565" font-family="Arial" font-size="10">✓ Timestamp Verification</text>
  <text x="215" y="525" font-family="Arial" font-size="10">✓ Device Authentication</text>
  <text x="215" y="545" font-family="Arial" font-size="10">✓ Input Validation</text>
  <text x="215" y="565" font-family="Arial" font-size="10">✓ Anomaly Detection</text>
  <text x="510" y="525" font-family="Arial" font-size="10">✓ Access Control</text>
  <text x="510" y="545" font-family="Arial" font-size="10">✓ Security Alerts</text>
  <text x="510" y="565" font-family="Arial" font-size="10">✓ Audit Logging</text>
  
  <!-- Arrows -->
  <!-- Sensor to RabbitMQ -->
  <line x1="220" y1="150" x2="340" y2="150" stroke="#333333" stroke-width="2" marker-end="url(#arrow)"/>
  <!-- RabbitMQ to Web Server -->
  <line x1="460" y1="150" x2="580" y2="150" stroke="#333333" stroke-width="2" marker-end="url(#arrow)"/>
  <!-- Web Server to Dashboard -->
  <line x1="640" y1="190" x2="640" y2="220" stroke="#333333" stroke-width="2" marker-end="url(#arrow)"/>
  <!-- Attacker connections -->
  <line x1="140" y1="150" x2="140" y2="320" stroke="#e74c3c" stroke-width="1" stroke-dasharray="5,5"/>
  <line x1="275" y1="150" x2="275" y2="320" stroke="#e74c3c" stroke-width="1" stroke-dasharray="5,5"/>
  <line x1="400" y1="150" x2="400" y2="320" stroke="#e74c3c" stroke-width="1" stroke-dasharray="5,5"/>
  <!-- Security Monitor connections -->
  <line x1="410" y1="400" x2="410" y2="520" stroke="#27ae60" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- Arrow Marker Definition -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333333"/>
    </marker>
  </defs>
</svg> 